---
import BaseLayout from '../../layouts/BaseLayout.astro';
import DataDisclaimer from '../../components/DataDisclaimer.astro';
import ImageGallery from '../../components/ImageGallery.astro';
import TechBadge from '../../components/TechBadge.astro';

const title = "Finance Dashboard v2.0";
const description = "Enterprise-grade financial reporting automation for GCC restaurant groups";

// Screenshot data - will be populated once screenshots are captured
const screenshots = [
  {
    src: '/portfolio_my/images/projects/finance-dashboard/executive-summary.webp',
    alt: 'Executive Summary Dashboard',
    caption: 'Executive Summary with key financial metrics and KPIs'
  },
  {
    src: '/portfolio_my/images/projects/finance-dashboard/regional-matrix.webp',
    alt: 'Regional Performance Matrix',
    caption: 'Regional performance comparison across 50+ locations'
  },
  {
    src: '/portfolio_my/images/projects/finance-dashboard/cfo-variance.webp',
    alt: 'CFO Variance Analysis',
    caption: 'Automated variance analysis with conditional formatting'
  },
  {
    src: '/portfolio_my/images/projects/finance-dashboard/concept-strategy.webp',
    alt: 'Concept Strategy Dashboard',
    caption: 'Concept-level profitability analysis by brand'
  },
  {
    src: '/portfolio_my/images/projects/finance-dashboard/cash-flow.webp',
    alt: 'Cash Flow Analysis',
    caption: 'Automated cash flow statement with formula integration'
  },
  {
    src: '/portfolio_my/images/projects/finance-dashboard/yoy-analysis.webp',
    alt: 'Year-over-Year Analysis',
    caption: 'Year-over-year comparison with trend visualization'
  }
];

const techStack = [
  'Python 3',
  'xlsxwriter',
  'openpyxl',
  'Pandas',
  'NumPy',
  'Multi-Currency FX'
];
---

<BaseLayout title={title} description={description}>
  <div class="max-w-6xl mx-auto px-6 py-12">

    <!-- Breadcrumb -->
    <nav class="text-sm mb-6">
      <a href="/portfolio_my/" class="text-blue-600 hover:underline">Home</a>
      <span class="mx-2">/</span>
      <a href="/portfolio_my/projects/" class="text-blue-600 hover:underline">Projects</a>
      <span class="mx-2">/</span>
      <span class="text-gray-600">Finance Dashboard v2.0</span>
    </nav>

    <!-- Hero Section -->
    <div class="mb-8">
      <h1 class="text-4xl md:text-5xl font-bold mb-4 gradient-text">{title}</h1>
      <p class="text-xl text-gray-600 mb-6">{description}</p>

      <!-- Tech Stack Badges -->
      <div class="flex flex-wrap gap-2 mb-6">
        {techStack.map(tech => <TechBadge name={tech} />)}
      </div>

      <!-- Category & Date -->
      <div class="flex gap-4 text-sm text-gray-500">
        <span>üìä Category: Dashboard & Analytics</span>
        <span>üìÖ Completed: Q4 2024</span>
      </div>
    </div>

    <DataDisclaimer />

    <!-- Executive Summary -->
    <section class="mb-12">
      <h2 class="text-3xl font-bold mb-4">Executive Summary</h2>

      <div class="prose prose-lg max-w-none">
        <h3 class="text-xl font-semibold mb-3">Business Problem</h3>
        <p class="text-gray-700 mb-4">
          GCC restaurant groups operating multiple brands across 50+ locations face significant
          challenges in financial consolidation. Manual processes for multi-currency conversion,
          concept-level profitability analysis, and executive variance reporting were consuming
          5+ days per month and prone to errors.
        </p>

        <h3 class="text-xl font-semibold mb-3">Solution Overview</h3>
        <p class="text-gray-700 mb-4">
          Developed an enterprise-grade financial reporting automation system that generates
          12 professional Excel dashboards (34 integrated sheets) with automated formulas,
          FX conversion across 5 currencies (AED, SAR, USD, EUR, GBP), conditional formatting,
          and AI-powered variance insights. The system processes 500+ financial data points
          and produces CFO-ready deliverables in under 2 minutes.
        </p>

        <h3 class="text-xl font-semibold mb-3">Key Results</h3>
        <ul class="list-disc pl-6 space-y-2 text-gray-700">
          <li>‚ö° <strong>85% time reduction</strong> - Monthly reporting time reduced from 5 days to &lt;1 day</li>
          <li>üí∞ <strong>Real-time profitability</strong> - Enabled concept-level P&L analysis by brand</li>
          <li>üìä <strong>Automated variance analysis</strong> - C-suite variance reports with AI-generated insights</li>
          <li>üåç <strong>Multi-currency consolidation</strong> - Automated FX conversion across 5 currencies</li>
          <li>‚úÖ <strong>Zero manual formulas</strong> - 100% automated Excel formula generation</li>
        </ul>
      </div>
    </section>

    <!-- Screenshots Gallery -->
    <section class="mb-12">
      <h2 class="text-3xl font-bold mb-6">Screenshots & Visuals</h2>
      <p class="text-gray-600 mb-6">
        Below are screenshots from the generated Finance Dashboard showing key reporting views.
        All data shown is sanitized dummy data for demonstration purposes.
      </p>
      <ImageGallery images={screenshots} projectName="finance-dashboard" />
    </section>

    <!-- Technical Overview -->
    <section class="mb-12">
      <details class="bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-lg border border-blue-200">
        <summary class="text-2xl font-bold cursor-pointer hover:text-blue-600 transition-colors">
          üîß Technical Overview (Click to Expand)
        </summary>

        <div class="mt-6 prose prose-lg max-w-none">
          <h3 class="text-xl font-semibold mb-3">Architecture & Tech Stack</h3>
          <p class="text-gray-700 mb-4">
            The system uses a modular Python architecture with separate modules for data processing,
            FX conversion, variance analysis, and Excel generation. Built with <code>xlsxwriter</code>
            for professional Excel formatting and <code>pandas</code> for data transformation.
          </p>

          <h3 class="text-xl font-semibold mb-3">Key Technical Features</h3>
          <ul class="list-disc pl-6 space-y-2 text-gray-700">
            <li><strong>Modular Design</strong> - Separate modules for data, FX, insights, and Excel generation</li>
            <li><strong>Multi-Currency Engine</strong> - Automated conversion across 5 currencies with real-time rates</li>
            <li><strong>Formula Automation</strong> - Generates Excel formulas programmatically (SUM, VLOOKUP, IF)</li>
            <li><strong>Conditional Formatting</strong> - Color-coded variance thresholds (red/yellow/green)</li>
            <li><strong>Professional Styling</strong> - Corporate Excel templates with headers, borders, number formats</li>
            <li><strong>Data Validation</strong> - Built-in error checking and data quality validation</li>
          </ul>

          <h3 class="text-xl font-semibold mb-3">Generated Output</h3>
          <p class="text-gray-700 mb-4">
            The system generates a single Excel workbook (GCC_Group_Finance_Master_Pack.xlsx)
            containing 34 integrated sheets:
          </p>
          <ul class="list-disc pl-6 space-y-1 text-gray-700 text-sm">
            <li>üìÑ ReadMe & Documentation</li>
            <li>üìä Executive Summary Dashboard</li>
            <li>üåç Regional Performance Matrix (5 regions)</li>
            <li>üìà CFO Variance Analysis (Budget vs Actual)</li>
            <li>üçî Concept Strategy (Brand-level P&L)</li>
            <li>üíµ Cash Flow Statement</li>
            <li>üìâ Year-over-Year Analysis</li>
            <li>üí± Multi-Currency Conversion Sheets (AED, SAR, USD, EUR, GBP)</li>
            <li>üîç Detailed P&L by Location (25+ sheets)</li>
          </ul>
        </div>
      </details>
    </section>

    <!-- Business Impact -->
    <section class="mb-12">
      <h2 class="text-3xl font-bold mb-4">Business Impact & Outcomes</h2>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Before -->
        <div class="bg-red-50 border-l-4 border-red-500 p-6 rounded-r-lg">
          <h3 class="font-bold text-lg mb-3 text-red-900">‚ùå Before Automation</h3>
          <ul class="space-y-2 text-sm text-red-800">
            <li>‚Ä¢ 5+ days manual consolidation per month</li>
            <li>‚Ä¢ Manual FX conversion errors</li>
            <li>‚Ä¢ No concept-level profitability visibility</li>
            <li>‚Ä¢ Delayed executive reporting</li>
            <li>‚Ä¢ Manual formula errors in Excel</li>
            <li>‚Ä¢ Limited variance analysis</li>
          </ul>
        </div>

        <!-- After -->
        <div class="bg-green-50 border-l-4 border-green-500 p-6 rounded-r-lg">
          <h3 class="font-bold text-lg mb-3 text-green-900">‚úÖ After Automation</h3>
          <ul class="space-y-2 text-sm text-green-800">
            <li>‚Ä¢ &lt;2 minutes report generation time</li>
            <li>‚Ä¢ 100% accurate multi-currency conversion</li>
            <li>‚Ä¢ Real-time brand profitability insights</li>
            <li>‚Ä¢ CFO-ready reports instantly available</li>
            <li>‚Ä¢ Zero manual formula creation</li>
            <li>‚Ä¢ AI-powered variance insights</li>
          </ul>
        </div>
      </div>

      <!-- ROI Metrics -->
      <div class="mt-6 bg-gradient-to-r from-blue-500 to-indigo-600 text-white p-6 rounded-lg">
        <h3 class="font-bold text-xl mb-4">üìà ROI & Value Created</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div>
            <div class="text-3xl font-bold">85%</div>
            <div class="text-sm opacity-90">Time Reduction</div>
          </div>
          <div>
            <div class="text-3xl font-bold">34</div>
            <div class="text-sm opacity-90">Automated Sheets</div>
          </div>
          <div>
            <div class="text-3xl font-bold">5</div>
            <div class="text-sm opacity-90">Currencies Supported</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Implementation Highlights -->
    <section class="mb-12">
      <h2 class="text-3xl font-bold mb-4">üí° Implementation Highlights</h2>

      <div class="prose prose-lg max-w-none">
        <h3 class="text-xl font-semibold mb-3">Innovation & Problem-Solving</h3>
        <ul class="list-disc pl-6 space-y-2 text-gray-700">
          <li>
            <strong>Dynamic Formula Generation</strong> - Developed algorithm to generate Excel formulas
            programmatically based on data structure, eliminating manual formula creation
          </li>
          <li>
            <strong>FX Rate Integration</strong> - Built multi-currency conversion engine with
            fallback rates and validation to ensure accuracy across 5 currencies
          </li>
          <li>
            <strong>Variance Insights AI</strong> - Implemented rule-based AI system to generate
            executive-friendly variance explanations and recommendations
          </li>
          <li>
            <strong>Professional Formatting</strong> - Created reusable Excel styling library with
            corporate templates, conditional formatting rules, and print optimization
          </li>
        </ul>

        <h3 class="text-xl font-semibold mt-6 mb-3">Scalability & Reusability</h3>
        <p class="text-gray-700">
          The modular architecture allows easy adaptation for different industries. The system
          has been successfully deployed for hospitality, retail, and F&B sectors with minimal
          configuration changes. The FX conversion module is reusable across any multi-currency
          reporting requirement.
        </p>
      </div>
    </section>

    <!-- Navigation -->
    <div class="flex justify-between items-center pt-8 border-t border-gray-200">
      <a href="/portfolio_my/projects/" class="btn btn-secondary">
        ‚Üê Back to Projects
      </a>
      <a href="/portfolio_my/projects/audit-tools/" class="btn btn-primary">
        Next Project: Audit Tools ‚Üí
      </a>
    </div>

  </div>
</BaseLayout>
