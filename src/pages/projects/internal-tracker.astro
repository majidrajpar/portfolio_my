---
import BaseLayout from '../../layouts/BaseLayout.astro';
import DataDisclaimer from '../../components/DataDisclaimer.astro';
import ImageGallery from '../../components/ImageGallery.astro';
import TechBadge from '../../components/TechBadge.astro';
const base = import.meta.env.BASE_URL;

const title = "Internal Audit Tracker";
const description = "Enterprise audit management system with executive dashboards and PowerPoint automation";

const screenshots = [
  {
    src: '/portfolio_my/images/projects/internal-tracker/ceo-dashboard.webp',
    alt: 'CEO Executive Dashboard',
    caption: 'CEO-level dashboard with KPIs, completion rates, and risk exposure analysis'
  },
  {
    src: '/portfolio_my/images/projects/internal-tracker/audit-committee-dashboard.webp',
    alt: 'Audit Committee Dashboard',
    caption: 'Governance dashboard for audit committee oversight with compliance metrics'
  },
  {
    src: '/portfolio_my/images/projects/internal-tracker/risk-assessment.webp',
    alt: 'Risk Assessment Matrix',
    caption: 'Automated risk scoring matrix with likelihood-impact calculations'
  },
  {
    src: '/portfolio_my/images/projects/internal-tracker/presentation-executive-summary.webp',
    alt: 'PowerPoint Executive Summary',
    caption: 'Automated PowerPoint generation with data-driven charts and executive metrics'
  }
];

const techStack = [
  'Python 3',
  'openpyxl',
  'python-pptx',
  'Excel Automation',
  'PowerPoint Automation',
  'Data Visualization'
];
---

<BaseLayout title={title} description={description}>
  <div class="max-w-6xl mx-auto px-6 py-12">

    <!-- Breadcrumb -->
    <nav class="text-sm mb-6">
      <a href={base} class="text-blue-400 hover:underline">Home</a>
      <span class="mx-2">/</span>
      <a href={`${base}projects/`} class="text-blue-400 hover:underline">Projects</a>
      <span class="mx-2">/</span>
      <span class="text-slate-400">Internal Audit Tracker</span>
    </nav>

    <!-- Hero Section -->
    <div class="mb-8">
      <h1 class="text-4xl md:text-5xl font-bold mb-4 gradient-text">{title}</h1>
      <p class="text-xl text-slate-400 mb-6">{description}</p>

      <!-- Tech Stack Badges -->
      <div class="flex flex-wrap gap-2 mb-6">
        {techStack.map(tech => <TechBadge name={tech} />)}
      </div>

      <!-- Category & Date -->
      <div class="flex gap-4 text-sm text-slate-500">
        <span>üîß Category: Audit Automation</span>
        <span>üìÖ Completed: Q2 2025</span>
      </div>
    </div>

    <DataDisclaimer />

    <!-- Executive Summary -->
    <section class="mb-12">
      <h2 class="text-3xl font-bold mb-4">Executive Summary</h2>

      <div class="prose prose-lg max-w-none">
        <h3 class="text-xl font-semibold mb-3">Business Problem</h3>
        <p class="text-slate-300 mb-4">
          Premium F&B chains need integrated audit management systems that connect audit planning,
          execution, findings tracking, and executive reporting. Manual Excel trackers lack automated
          formulas, cross-references, and executive dashboards. Audit committee presentations require
          hours of manual PowerPoint creation, delaying critical governance communications.
        </p>

        <h3 class="text-xl font-semibold mb-3">Solution Overview</h3>
        <p class="text-slate-300 mb-4">
          Developed enterprise-grade Excel tracker (9 integrated worksheets) with automated formulas,
          cross-references, and conditional formatting, plus PowerPoint presentation generator that
          creates 20+ data-driven slides directly from tracker data. System includes 3-tier executive
          dashboards (CEO, Audit Committee, Director) aligned with IIA Standards and COSO Framework.
        </p>

        <h3 class="text-xl font-semibold mb-3">Key Results</h3>
        <ul class="list-disc pl-6 space-y-2 text-slate-300">
          <li>üìä <strong>3-tier executive dashboards</strong> - CEO, Audit Committee, Director views with automated KPIs</li>
          <li>üéØ <strong>Automated risk scoring</strong> - Likelihood √ó Impact calculations with color-coded thresholds</li>
          <li>üìà <strong>One-click PowerPoint generation</strong> - 20+ slides with data-driven charts in seconds</li>
          <li>üîó <strong>9 integrated worksheets</strong> - Cross-referenced audit universe, findings, action plans</li>
          <li>‚úÖ <strong>IIA & COSO alignment</strong> - Built-in compliance with professional standards</li>
        </ul>
      </div>
    </section>

    <!-- Screenshots Gallery -->
    <section class="mb-12">
      <h2 class="text-3xl font-bold mb-6">Dashboards & Automation Features</h2>
      <p class="text-slate-400 mb-6">
        Below are screenshots from the audit tracker showcasing executive dashboards, risk scoring,
        and automated PowerPoint generation. All data shown is sanitized for demonstration.
      </p>
      <ImageGallery images={screenshots} projectName="internal-tracker" />
    </section>

    <!-- Technical Overview -->
    <section class="mb-12">
      <details class="bg-slate-800/60 p-6 rounded-lg border border-blue-500/30">
        <summary class="text-2xl font-bold cursor-pointer hover:text-blue-400 transition-colors">
          üîß Technical Overview (Click to Expand)
        </summary>

        <div class="mt-6 prose prose-lg max-w-none">
          <h3 class="text-xl font-semibold mb-3">System Architecture</h3>
          <p class="text-slate-300 mb-4">
            The tracker uses openpyxl for Excel automation and python-pptx for PowerPoint generation.
            All 9 worksheets are programmatically created with automated formulas, data validation,
            conditional formatting, and cross-references. The PowerPoint generator reads live data
            from the Excel tracker to create presentation slides.
          </p>

          <h3 class="text-xl font-semibold mb-3">9 Integrated Worksheets</h3>

          <h4 class="font-bold mb-2">Planning & Risk Assessment</h4>
          <ul class="list-disc pl-6 space-y-1 text-slate-300 text-sm mb-4">
            <li><strong>Reference Data</strong> - Master dropdown lists (departments, risk levels, audit types, statuses)</li>
            <li><strong>Audit Universe</strong> - Complete inventory of auditable entities with metadata</li>
            <li><strong>Risk Assessment</strong> - Automated risk scoring (Likelihood √ó Impact) with color coding</li>
            <li><strong>Annual Audit Plan</strong> - Risk-based audit scheduling with resource allocation and tracking</li>
          </ul>

          <h4 class="font-bold mb-2">Execution & Tracking</h4>
          <ul class="list-disc pl-6 space-y-1 text-slate-300 text-sm mb-4">
            <li><strong>Findings Tracker</strong> - Detailed audit findings with categorization (Condition, Criteria, Cause, Consequence, Recommendation)</li>
            <li><strong>Action Plans</strong> - Management remediation tracking with aging analysis and overdue highlighting</li>
          </ul>

          <h4 class="font-bold mb-2">Reporting & Dashboards</h4>
          <ul class="list-disc pl-6 space-y-1 text-slate-300 text-sm mb-4">
            <li><strong>CEO Dashboard</strong> - Executive KPIs: total audits, completion %, critical findings, risk exposure</li>
            <li><strong>Audit Committee Dashboard</strong> - Governance metrics vs. targets, compliance status, quarterly trends</li>
            <li><strong>Director Dashboard</strong> - Operational metrics: resource utilization, budget tracking, team performance</li>
          </ul>

          <h3 class="text-xl font-semibold mb-3 mt-6">Automated Features</h3>

          <ul class="list-disc pl-6 space-y-2 text-slate-300">
            <li>
              <strong>Risk Score Formulas</strong> - Inherent Risk = Likelihood √ó Impact, with automatic rating assignment
              (Critical ‚â•12, High ‚â•9, Medium ‚â•6, Low &lt;6)
            </li>
            <li>
              <strong>Days Open Calculation</strong> - IF(CloseDate="", TODAY()-IssueDate, CloseDate-IssueDate) for
              automatic aging of open findings
            </li>
            <li>
              <strong>Completion Percentage</strong> - CompletedAudits/TotalAudits with conditional formatting for
              targets (Green ‚â•80%, Yellow 60-79%, Red &lt;60%)
            </li>
            <li>
              <strong>Cross-References</strong> - Findings link to Audit IDs, Action Plans reference Finding IDs,
              Dashboards pull from all worksheets
            </li>
            <li>
              <strong>Data Validation</strong> - Dropdown lists prevent data entry errors and ensure consistency across
              departments, risk levels, and statuses
            </li>
            <li>
              <strong>Conditional Formatting</strong> - Color-coded risk levels (Red/Yellow/Green), overdue action
              plans highlighted automatically
            </li>
          </ul>

          <h3 class="text-xl font-semibold mb-3 mt-6">PowerPoint Automation (20+ Slides)</h3>

          <p class="text-slate-300 mb-4">
            The presentation generator creates a complete audit committee presentation with:
          </p>

          <ul class="list-disc pl-6 space-y-1 text-slate-300 text-sm mb-4">
            <li>Title slide with corporate branding</li>
            <li>Agenda and meeting outline</li>
            <li>Executive summary with visual KPI metrics</li>
            <li>Audit plan status (pie chart + status table)</li>
            <li>Risk assessment distribution (bar chart)</li>
            <li>Critical findings table (filtered from tracker)</li>
            <li>Findings by department (horizontal bar chart)</li>
            <li>Management action plan status and tracking</li>
            <li>KPI dashboard with performance vs. targets</li>
            <li>Compliance & governance checklist</li>
            <li>Key recommendations and next steps</li>
            <li>Closing slide for Q&A</li>
          </ul>

          <p class="text-slate-300 mb-4">
            All charts and data tables are automatically populated from the Excel tracker, ensuring
            presentations are always up-to-date with zero manual data entry.
          </p>

          <h3 class="text-xl font-semibold mb-3 mt-6">Professional Standards Alignment</h3>

          <ul class="list-disc pl-6 space-y-2 text-slate-300">
            <li><strong>IIA Standards</strong> - Standard 2010 (Planning), 2120 (Risk Management), 2400 (Communicating Results), 2500 (Monitoring Progress)</li>
            <li><strong>COSO Framework</strong> - Risk Assessment, Control Activities, Information & Communication, Monitoring Activities</li>
            <li><strong>Three Lines of Defense</strong> - Third line (internal audit) positioning and role clarity</li>
          </ul>
        </div>
      </details>
    </section>

    <!-- Business Impact -->
    <section class="mb-12">
      <h2 class="text-3xl font-bold mb-4">Business Impact & Outcomes</h2>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Before -->
        <div class="bg-red-950/30 border-l-4 border-red-500 p-6 rounded-r-lg">
          <h3 class="font-bold text-lg mb-3 text-red-300">‚ùå Before Audit Tracker</h3>
          <ul class="space-y-2 text-sm text-red-200">
            <li>‚Ä¢ Manual Excel with no formulas (error-prone)</li>
            <li>‚Ä¢ No executive dashboards</li>
            <li>‚Ä¢ 5+ hours to create PowerPoint presentations</li>
            <li>‚Ä¢ No cross-references between worksheets</li>
            <li>‚Ä¢ Manual risk score calculations</li>
            <li>‚Ä¢ Inconsistent data entry (no validation)</li>
          </ul>
        </div>

        <!-- After -->
        <div class="bg-green-900/20 border-l-4 border-green-500 p-6 rounded-r-lg">
          <h3 class="font-bold text-lg mb-3 text-green-300">‚úÖ After Audit Tracker</h3>
          <ul class="space-y-2 text-sm text-green-200">
            <li>‚Ä¢ 100% automated formulas (zero errors)</li>
            <li>‚Ä¢ 3-tier executive dashboards</li>
            <li>‚Ä¢ One-click PowerPoint (&lt;30 seconds)</li>
            <li>‚Ä¢ Complete cross-references</li>
            <li>‚Ä¢ Automated risk scoring with color codes</li>
            <li>‚Ä¢ Validated data entry (dropdown lists)</li>
          </ul>
        </div>
      </div>

      <!-- ROI Metrics -->
      <div class="mt-6 bg-gradient-to-r from-blue-500 to-indigo-600 text-white p-6 rounded-lg">
        <h3 class="font-bold text-xl mb-4">üìà ROI & Value Created</h3>
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
          <div>
            <div class="text-3xl font-bold">9</div>
            <div class="text-sm opacity-90">Integrated Worksheets</div>
          </div>
          <div>
            <div class="text-3xl font-bold">3</div>
            <div class="text-sm opacity-90">Executive Dashboards</div>
          </div>
          <div>
            <div class="text-3xl font-bold">20+</div>
            <div class="text-sm opacity-90">PowerPoint Slides</div>
          </div>
          <div>
            <div class="text-3xl font-bold">&lt;30s</div>
            <div class="text-sm opacity-90">Presentation Generation</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Implementation Highlights -->
    <section class="mb-12">
      <h2 class="text-3xl font-bold mb-4">üí° Implementation Highlights</h2>

      <div class="prose prose-lg max-w-none">
        <h3 class="text-xl font-semibold mb-3">Innovation & Problem-Solving</h3>
        <ul class="list-disc pl-6 space-y-2 text-slate-300">
          <li>
            <strong>PowerPoint Automation</strong> - Developed python-pptx integration that reads Excel
            tracker data and generates 20+ slides with charts, tables, and metrics. Reduced presentation
            preparation time from 5+ hours to under 30 seconds.
          </li>
          <li>
            <strong>3-Tier Dashboard Architecture</strong> - Created tailored dashboards for CEO
            (strategic metrics), Audit Committee (governance oversight), and Director (operational
            management), ensuring each stakeholder sees relevant KPIs.
          </li>
          <li>
            <strong>Automated Risk Scoring</strong> - Implemented COSO-aligned likelihood-impact matrix
            with automatic rating assignment and color-coded conditional formatting for instant visual
            risk identification.
          </li>
          <li>
            <strong>Cross-Worksheet Integration</strong> - Built complete data linking system where
            findings reference audit plans, action plans link to findings, and dashboards aggregate
            across all worksheets for single source of truth.
          </li>
        </ul>

        <h3 class="text-xl font-semibold mt-6 mb-3">Scalability & Reusability</h3>
        <p class="text-slate-300">
          The tracker's modular design allows deployment across any industry requiring audit management.
          Successfully customized for retail, manufacturing, healthcare, and financial services sectors.
          The PowerPoint automation module is reusable for any Excel-to-presentation workflow. Python
          scripts enable rapid customization of departments, risk levels, and KPI definitions to match
          organization-specific audit methodologies.
        </p>
      </div>
    </section>

    <!-- Navigation -->
    <div class="flex justify-between items-center pt-8 border-t border-white/10">
      <a href={`${base}projects/forensic-toolbox/`} class="btn btn-secondary">
        ‚Üê Previous: Forensic Toolbox
      </a>
      <a href={`${base}projects/`} class="btn btn-primary">
        Back to Projects
      </a>
    </div>

  </div>
</BaseLayout>
